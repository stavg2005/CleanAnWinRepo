@inject NavigationManager NavManager;
@inject UserService Userservice
@inject AuthService AuthService
@page "/store"
@using Model;
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/shop.css">
    <title>Your Web Page</title>
</head>
<body style="overflow-y:scroll">

    <header class="fixed-header">
        <h1>You have @Userservice.CurrentUser.coins coins <img src="css/imags/coin.png" class="coin" /> </h1>
    </header>

    <section class="content">
        <div class="box">
            <img src="css/imags/coin.png" class="coin" />
            <h2 class="coins">@Userservice.CurrentUser.coins</h2>
        </div>

        <div class="profile">
            <img src="images/profile-pic.png" class="profile-pic" />
        </div>

        <div class="store-container">
            @{
                if(b)
                    {
                    foreach (Product i in l)
                    {
                        <div class="product">
                            
                            
                            <img src="@(path+Convert.ToBase64String(i.ProductPicture))" class="product-picture" alt="Product 1">
                            <div class="product-name" @onclick="() =>GoToProuctPage(i.ProductID)">
                                <h2>@i.ProductName <br /><p> <img class="coin" src="css/imags/coin.png"   style="top:80%;right:80%"/>@i.ProductPrice</p></h2>
                            </div>
                        </div>
                    }
                }
            }
          <div style="position:relative;height:100px"></div>

            <!-- Add more product entries as needed -->

@*             <div class="navbar">
                <img src="css/imags/bin.png" />
                <img src="css/imags/bag.png" />
                <img src="css/imags/user.png" />
            </div> *@
        </div>
    </section>

    <footer style="background-color:white">

        <div class="navbar">
            <img src="css/imags/bin.png" />
            <img src="css/imags/bag.png" />
            <img src="css/imags/user.png" />
        </div>
    </footer>

</body>

@* <div style="position:fixed;top: 3%; left:0%;text-align: center;border-radius:20px;border-color:black;border:5px,solid;">
    <img src="css/imags/coin.png" style="width:20px;height:20px;position:absolute;right:80%" />
    <h2 style="margin-left:35px;top:25%"> @Userservice.CurrentUser.coins </h2>
</div>
<img style="width:60px;height:60px;" class="profile-pic" src="@(path+Convert.ToBase64String(Userservice.CurrentUser.profile))" />
<body style="overflow-y:scroll">

    <div class="store-container">
        @if (b)
        {
            foreach (Product i in l)
            {
                <div class="product" style="margin-top:200px;position:relative;">
                    <img src="css/imags/coin.png" style="position:absolute;width:30px;height:30px;margin-left:250px;margin-top:-150px; z-index: 1;" />
                    <div style="position:absolute;z-index:2"><h2>@i.ProductPrice</h2> </div>
                <img src = "@(path+Convert.ToBase64String(i.ProductPicture))" style="width:300px;height:200px" alt="Product 1" @onclick="() =>GoToProuctPage(i.ProductID)">
                    <div style="width:300px;height:100px;background-color:#ddebf4;position:absolute;margin-left:240px;margin-top:-1px;z-index:1;" class="product-name"><h2>@i.ProductName <br /><p>@i.ProductPrice</p></h2></div>
                 </div>
 

            }
            <div class="navbar" style="border-top: 5px solid blue; z-index:3">
                
                <img src="css/imags/bin.png" style="width:50px;height:50px" />
                <img src="css/imags/bag.png" style="width:50px;height:50px" />
                <img src="css/imags/user.png" style="width:50px;height:50px" />

            </div>

        }

    </div>

</body> *@

@code {
    List<Product> l = null;
    ApiServices es = new ApiServices();
    bool b = false;
    string path = "data:image/png;base64,";
    protected override async Task OnInitializedAsync()
    {

        await InsertValuesToUserService();
        await GetC(Userservice.CurrentUser.UserID, true);
    }
    private async Task InsertValuesToUserService()
    {
        Userservice.CurrentUser = await AuthService.GetUserInfo();

    }

    private void GoToProuctPage(int id)
    {
            NavManager.NavigateTo($"/item/{id.ToString()}");
    }
    public async Task GetC(int id, bool isphone)
    {
        l = await es.GetALLProducts();
        b = true;
    }
}
